apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: "default"
  resource: "post"
  importDerivedRoles:
    - post_roles
  rules:
    - actions: ["create"]
      effect: EFFECT_ALLOW
      roles:
        - user
        - agent
        - manager
        - admin
        - owner
    
    - actions: ["read"]
      effect: EFFECT_ALLOW
      roles:
        - user
        - agent
        - manager
        - admin
        - owner

    - actions: ["update"]
      effect: EFFECT_ALLOW
      roles:
        - manager
        - admin
        - owder
      derivedRoles:
        - owner

    - actions: ["delete"]
      effect: EFFECT_ALLOW
      roles:
        - owner
      derivedRoles:
        - owner
